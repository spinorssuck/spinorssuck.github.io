<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Topological Constraints on the Universal Approximation of Neural Networks | Rithvik Reddy Golamari</title> <meta name="author" content="Rithvik Reddy Golamari"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://spinorssuck.github.io/blog/2019/topologicalconstraints/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?6185d15ea1982787ad7f435576553d64"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Rithvik </span>Reddy Golamari</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Topological Constraints on the Universal Approximation of Neural Networks</h1> <p class="post-meta">July 29, 2019</p> <p class="post-tags"> <a href="/blog/2019"> <i class="fa-solid fa-calendar fa-sm"></i> 2019 </a>   ·   <a href="/blog/tag/algebra"> <i class="fa-solid fa-hashtag fa-sm"></i> algebra</a>   <a href="/blog/tag/topology"> <i class="fa-solid fa-hashtag fa-sm"></i> topology</a>   <a href="/blog/tag/neural-net"> <i class="fa-solid fa-hashtag fa-sm"></i> neural-net</a>     ·   <a href="/blog/category/cs"> <i class="fa-solid fa-tag fa-sm"></i> cs</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>The title may seem like a contradiction given that there is such a thing as the Universal Approximation Theorem which simply states that a neural network with a single hidden layer of finite width(i.e finite number of neurons) can approximate any function on a compact set of \(\mathbb{R}^{n}\) given that the activation function is non-constant,bounded and continuous.</p> <p>Needless to say, I haven’t found any kind of flaws in the existing proofs(see Kolmogrov or Cybenko). However, I thought of something a little simple and scoured the internet for an answer.</p> <p>What if we allow an arbitrary number of hidden layers and bound the dimension of the hidden layers making them ‘Deep, Skinny Neural Networks’? Would that be a universal approximator?</p> <p>The answer is No and I found it out from a paper by Jesse Johnson who proved it using nothing but basic topology for a particular class of neural networks. This seems quite important because quite often, in application, multiple hidden layers of low dimension are used in machine learning. Also, the kinds of restrictions the author placed on the activation function and the neural network appear quite commonly in the real-world.</p> <p>Setting Up the Notation</p> <p>Before I proceed to the proof, I’ll just set in place the required notation that will be used throughout.</p> <p>Let \(M(\phi,n_{0},n_{1},\cdots ,n_{l})\) be set of all functions in a layered classic feed-forward neural network with activation function \(\phi\), input dimension \(n_{0}\), output dimension \(n_{l}\) and hidden layer dimension \(n_{i}\) for \(i &lt; l\).</p> <p>Given this, let \(\tilde{M} (\phi,n)\) to be the union of the family of functions \(M(\phi,n_{0},n_{1},\cdots ,n_{l})\) where \(n_{i} \leq N, 0 \leq i \leq N\) for some fixed natural number \(N\).</p> <p>A function in \(\tilde{M} (\phi,n)\) is said to be nonsingular if \(\phi\) is continuous and injective, \(n_{i}=n\) and the weight matrix \(W\) is nonsingular. The set of all functions in the families \(\tilde{M} (\phi ,n)\) for fixed \(n\) and varying activation functions which are continuous and injective is denoted by \(\tilde{M} (n)\).</p> <table> <tbody> <tr> <td>Given some function \(\psi:\mathbb{R}^{n} \mapsto \mathbb{R}^{m}\) and a compact subset \(A\) of \(\mathbb{R}^{n}\), another function \(f\) is said to \((\epsilon , A)-approximate\) \(\psi\) if for every $$ x \in A,</td> <td>\psi(x)-f(x)</td> <td>&lt;\epsilon $$.</td> </tr> </tbody> </table> <p>An activation function \(\phi\) is uniformly approximated by injective functions if there if there is a sequence of continuous, injective functions which uniformly converge to \(\phi\). This would allow common activation functions such as ISRU, tanh and the sigmoid function to be approximated trivially. Functions such as RELu have a horizontal line in their graph and it’s easy to appropriately choose a sequence of injective functions which will converge to RELu(try to do this yourself).</p> <p>One key observation is that any function \(f \in \tilde{M} (\phi,n)\) can be written as:</p> \[f=\phi_{\kappa} \circ l_{\kappa} \circ \cdots \circ \phi_{1} \circ l_{1} \circ \phi_{0} \circ l_{0}\] <p>(1)</p> <p>where \(\phi_{i}\) are the activation functions and \(l_{i}\) are linear functions determined by the weights associated with a particular layer. This is typically how we imagine forward propagation of fully connected neural networks to work.</p> <p>The main theorem of his paper deals with path components associated with pre-images of level sets. So, going forward, it’ll be better to put forth a definition.</p> <p>A function \(f:\mathbb{R}^{n} \mapsto \mathbb{R}\) has unbounded level components if for every \(x \in mathbb{R}\), the path components of \(f^{-1}(x)\) are all unbounded.</p> <p>Preliminary results</p> <p>Before, moving onto the main theorem, I’d like to simply list some rather obvious lemmas.</p> <p>In (1), I mentioned the decomposition of functions in \(\tilde{M}(\phi, n)\). So, now  consider some function \(f:\mathbb{R}^{n} \mapsto \mathbb{R}^{m}\) which can be decomposed as \(f=f_{\kappa} \circ \cdots \circ f_{1} \circ f_{0}\) where each \(f_{i}: \mathbb{R}^{n_{i}} \mapsto \mathbb{R}^{n_{i+1}}\) is a linear function between Euclidean spaces.</p> <p>If there are another set of functions \(g_{i}: \mathbb{R}^{n_{i}} \mapsto \mathbb{R}^{n_{i+1}}\) than \((\epsilon , A_{i})-approximate\) each corresponding \(f_{i}\) for some compact sets \(A_{i} \subset \mathbb{R}^{n_{i}}\), then the composition  \(g=g_{\kappa} \circ \cdots g_{0}\) \((\epsilon,A)-approximates\) \(f\) for some compact set \(A \subset \mathbb{R}^{n}\).</p> <p>Lemma 1:</p> <p>If \(f\) is approximated by some function in \(\tilde{M} (\phi,n)\) where the activation function \(\phi\) can be uniformly approximated by injective functions, then \(f\) can be approximated by a function in \(\tilde{M}\)</p> <p>Proof:</p> <p>The proof is pretty simple so I skip it in typical mathematical snobbery. If you wish to prove it for yourself, start off by showing that every function in \(\tilde{M} (\phi, n)\) can be approximated by a function in \(\tilde{M}(n)\).Note that you can appropriately make \(n_{i}=n\) for every hidden layer even if the width is less than \(n\) by appropriately inserting zeros in the weight matrix. Now, the next hint is a way to deal with those pesky singular linear functions \(l_{i}\). The set of all non singular \(n \times n\) matrices form an open dense set in the space of all \(n \times n\) matrices, i.e the set of all singular matrices form a Lebesgue zero measure set. This can be understood by considering these spaces to be manifolds in \(\mathbb{R}^{n^{2}}\) so perturbing elements appropriately in a singular matrix makes it non-singular so that any arbitrarily small change in the value of the linear transformation associated with the singular function can be approximated by a non-singular one.</p> <p>Now, you’ve shown that every function in \(\tilde{M} (\phi, n)\) can be approximated by a function in \(\tilde{M}(n)\) and given that \(f\) is approximated by some function in \(\tilde{M} (\phi,n)\), you can combine the results to prove the lemma.</p> <p>This section ends with a key lemma on the functions in \(\tilde{M} (n)\).</p> <p>Lemma 2:</p> <p>If \(f:\mathbb{R}^{n} \mapsto \mathbb{R}\) is a function in \(\tilde{M} (n)\), then for every \(x \in \mathbb{R}\), the level set \(f^{-1}(x)\) is homeomorphic to an open subset of \(\mathbb{R}^{n-1}\). Hence, it has unbounded level components.</p> <p>Sketch of the proof:</p> <p>Again, the lemma is quite easy to prove. I’ll provide a rough sketch of the proof. Writing the function \(f\) as:</p> <p>\(f=g \circ f'\) where \(f':\mathbb{R}^{n} \mapsto \mathbb{R}^{n}\) is an  linear function and \(g=\phi \circ g'\) where \(g'\) is a linear function to \(\mathbb{R}\). Essentially, we are writing the f as the compositions associated to the last layer of the neural network and the remaining layers. \(f'\) is injective and continuous because the activation function is injective and continuous, and \(f\) is singular by definition.</p> <p>Once you work through the simple details, it’s revealed that \(f^{-1}(x)\) is an open subset of \(\mathbb{R}^{n-1}\). On the other hand, \(f^{-1}(x)\) is also closed in \(\mathbb{R}^{n}\)by the properties of continuous functions. If it was bounded, then the set would be a compact subset of \(\mathbb{R}^{n}\) making it empty so \(f^{-1}(x)\) is either unbounded or empty. Hence, the path components of this set are unbounded.</p> <p>Towards the Main Theorem</p> <p>The final result of the paper is that deep, skinny networks can only approximate functions with unbounded level components.</p> <p>What we have proven is that every function that can be approximated by a function in \(\tilde{M} (\phi, n)\) can be approximated by a function in \(\tilde{M} (n)\) and that the level sets of the functions in \(\tilde{M} (n)\) have unbounded level components. Now, it remains to prove that every function approximated by a function in \(\tilde{M} (n)\) also has unbounded level components.</p> <p>So, the topological constraint is that functions with bounded level components can not be approximated by a function in \(\tilde{M} (\phi, n)\) where \(\phi\) is a continuous activation function that can uniformly approximated by injective functions.</p> <p>Theorem:</p> <p>Any function \(f\) approximated by a function in \(\tilde{M} (n)\) has unbounded level components.</p> <p>Proof:</p> <p>Assume to the contrary that \(f:\mathbb{R}^{n} \mapsto \mathbb{R}\) has bounded level components. Consider some level set \(f^{-1}(x)\) for \(x \in \mathbb{R}\). \(f^{-1}(x)\) is closed and components are also closed.Since, components are bounded, both these sets are compact.</p> <p>Hence, there exists a number \(\lambda&gt;0\) such that every element of \(f^{-1}(x)\backslash C\) is at a distance greater than \(\lambda\) from \(C\).</p> <table> <tbody> <tr> <td>Define $$ \eta_{C}={y \in \mathbb{R}^{n};</td> <td> </td> <td>y-c</td> <td> </td> <td>}&lt; \frac{\lambda}{2}, c \in C } \(. Let\) T \(be the boundary of this open set\) \eta_{C} \(.\) T \(is closed and also bounded since it is at a bounded distance\) \frac{\lambda}{2} \(from\) C $$(which is bounded itself).</td> </tr> </tbody> </table> <p>\(f(T)\) is also compact and \(x\) is disjoint from it. Since the complement of the set is open, there exists some neighborhood \(U=[x- \epsilon,x+ \epsilon]\) of \(x\) that is disjoint from \(f(T)\).</p> <p>\(f^{-1}(U)\) obviously contains \(f^{-1}(x)\) and has a component \(\tilde{C}\) that contains \(C\). \(f^{-1}(U)\) intersects \(\eta_{C}\) and is disjoint from the boundary \(T\). Therefore, \(f^{-1}(U) \subset \eta_{C}\). So, \(\tilde{C}\) is also compact.</p> <table> <tbody> <tr> <td>It’s given that \(f\) is approximated by a function in \(\tilde{M} (n)\). Let $$ r=max({</td> <td> </td> <td>c’-c</td> <td> </td> <td>, c \in C,c’ \in \tilde{C} }) \(. Bear in mind that this number is finite since\) \tilde{C} \(is bounded and contains\) C $$.</td> </tr> </tbody> </table> <p>Let \(c\) be an element of \(C\).</p> <p>Consider some connected compact neighborhood \(A\) of \(c\) such that there is the boundary is at a distance \(R&gt;r\). The simplest example of such a neighborhood would be the closed ball \(B_{R}(c)\).</p> <p>So, choose a function \(g \in  \tilde{M}(n)\) that \((\frac{\epsilon}{2},A)-approximates\) \(f\).</p> <table> <tbody> <tr> <td>$$ \Rightarrow</td> <td> </td> <td>g(y)-f(y)</td> <td> </td> <td>&lt;\frac{\epsilon}{2} \forall y\in A \(. Since\) f(c)=x $$,</td> </tr> </tbody> </table> <p>\(g(c) \in [x-\frac{\epsilon}{2},x+\frac{\epsilon}{2}] \subset U\).</p> <table> <tbody> <tr> <td>Since \(g \in \tilde{M} (n)\), the level components are unbounded, so the components of \(g^{-1}(g(c))\) are unbounded. We can construct a path \(\gamma\) from \(c\) to a point that is at a distance \(R\) from \(c\) such that every point in \(\gamma\) lies in \(A\). This means that $$</td> <td> </td> <td>g(y’)-f(y’)</td> <td> </td> <td>&lt; \frac{\epsilon}{2} \forall y’ \in \gamma \(. Since\) \gamma \subset g^{-1}(g(c)) \(,\) g(y’)=g(c) \in [x-\frac{\epsilon}{2},x+\frac{\epsilon}{2}] $$ by the previous equation and inequality.</td> </tr> </tbody> </table> <p>So, \(f(y') \in [x-\epsilon,x+\epsilon]=U\). The path \(\gamma\) is contained in one of the components of \(g^{-1}(U)\) and since it contains \(c\), this component is \(C\).</p> <p>But we constructed the path so that it starts from \(c\) and ends at a point whose distance from \(c\) is greater than \(r\). This is a contradiction by the definition of \(r\).</p> <p>Well, that ends the proof. J. Johnson presents examples of how these restrictions apply to real-world machine learning problems which you can find in the last few pages of his paper.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2020/fastgeneralizeddft/">Fast Generalized DFT for finite groups</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2020/groupcohomology/">Bar resolutions, Group Cohomology and some cool applications</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2020/bousfield-localization/">Bousfield Localization of Spectra</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2020/monads1/">Monads I, The Eilenberg-Moore category, Adjunction and Kleisli categories</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/irrationaltrighyper/">Irrationality of basic trigonometric and hyperbolic functions at rational values</a> </li> </div> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Rithvik Reddy Golamari. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?9b43d6e67ddc7c0855b1478ee4c48c2d" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>